<html>
<head>
    <meta charset="utf-8"/>
<meta name="description" content=""/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>[RECA学习营]第二周 | 学习小组</title>
<link rel="shortcut icon" href="https://baldstudio.cn/favicon.ico?v=1589369544016">
<link href="https://cdn.bootcss.com/font-awesome/5.11.2/css/all.css" rel="stylesheet">
<link rel="stylesheet" href="https://baldstudio.cn/styles/main.css">
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
      integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

<script src="https://cdn.bootcss.com/highlight.js/9.15.10/highlight.min.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.15.10/languages/dockerfile.min.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.15.10/languages/dart.min.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.15.10/languages/go.min.js"></script>
<script src="https://cdn.bootcss.com/moment.js/2.23.0/moment.min.js"></script>
<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
        integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n"
        crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
        integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
        crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
        integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
        crossorigin="anonymous"></script>

<!-- DEMO JS -->
<!--<script src="media/scripts/index.js"></script>-->



    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
</head>
<body>
<div class="main gt-bg-theme-color-first">
    <nav class="navbar navbar-expand-lg">
    <div class="navbar-brand">
        <img class="user-avatar" src="/images/avatar.png" alt="头像">
        <div class="site-name gt-c-content-color-first">
            学习小组
        </div>
    </div>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <i class="fas fa-bars gt-c-content-color-first" style="font-size: 18px"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <div class="navbar-nav mr-auto" style="text-align: center">
            
                <div class="nav-item">
                    
                        <a href="/" class="menu gt-a-link">
                            首页
                        </a>
                    
                </div>
            
                <div class="nav-item">
                    
                        <a href="/archives" class="menu gt-a-link">
                            归档
                        </a>
                    
                </div>
            
                <div class="nav-item">
                    
                        <a href="/tags" class="menu gt-a-link">
                            标签
                        </a>
                    
                </div>
            
                <div class="nav-item">
                    
                        <a href="/post/about" class="menu gt-a-link">
                            关于
                        </a>
                    
                </div>
            
        </div>
    </div>
</nav>
    <div class="post-container">
        <div class="post-detail gt-bg-theme-color-second">
            <article class="gt-post-content">
                <h2 class="post-title">
                    [RECA学习营]第二周
                </h2>
                <div class="post-info">
                    <time class="post-time gt-c-content-color-first">
                        · 2020-04-27 ·
                    </time>
                    
                </div>
                <div class="post-content">
                    <p><strong>作者: 蒋晨辉</strong></p>
<h3 id="需要掌握的内容">需要掌握的内容：</h3>
<p>本周主要学习RT-Thread env工具以及基础外设的使用、finsh组件</p>
<ul>
<li>1、env的使用
<ul>
<li>学习文档：<a href="https://www.rt-thread.org/document/site/programming-manual/env/env/">env用户手册</a>、<a href="https://www.rt-thread.org/document/site/programming-manual/kconfig/kconfig/">Kconfig</a></li>
<li>学习视频：<a href="https://www.rt-thread.org/document/site/tutorial/env-video/">env视频教程</a></li>
</ul>
</li>
<li>2、finsh的使用
<ul>
<li>学习文档：<a href="https://www.rt-thread.org/document/site/programming-manual/finsh/finsh/">FinSH</a></li>
<li>学习视频：查看群里分享的资料，第二期视频
<ul>
<li>《3.Finsh组件》，了解下finsh组件</li>
</ul>
</li>
</ul>
</li>
<li>3、常用设备与驱动
<ul>
<li>学习文档
<ul>
<li><a href="https://www.rt-thread.org/document/site/programming-manual/device/device/">IO设备模型</a></li>
<li><a href="https://www.rt-thread.org/document/site/programming-manual/device/pin/pin/">PIN</a></li>
<li><a href="https://www.rt-thread.org/document/site/programming-manual/device/uart/uart/">UART</a></li>
<li><a href="https://www.rt-thread.org/document/site/programming-manual/device/i2c/i2c/">IIC</a></li>
<li><a href="https://www.rt-thread.org/document/site/programming-manual/device/spi/spi/">SPI</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="目标">目标</h3>
<p>在<strong>掌握以上内容之后</strong>，我们在此基础上<strong>还</strong>需要完成以下几个目标：</p>
<p>目标1：了解PIN设备的使用步骤，能在自己开发板上使用RTT PIN设备驱动按键。<br>
使用PIN设备的一般步骤为</p>
<ol>
<li>获取PIN设备<br>
如果使用STM32的BSP,可以用<code>GET_PIN(port, pin)</code></li>
<li>设置PIN设备</li>
</ol>
<pre><code class="language-c">void rt_pin_mode(rt_base_t pin, rt_base_t mode);
</code></pre>
<ol start="3">
<li>读取/设置输入/输出电平</li>
</ol>
<pre><code class="language-c">int rt_pin_read(rt_base_t pin);
void rt_pin_write(rt_base_t pin, rt_base_t value);
</code></pre>
<p>在自己板上使用RTT PIN的设备驱动按键示例</p>
<pre><code class="language-c">#define KEY0_PIN GET_PIN(F,13)

int main(void)
{
    rt_pin_mode(KEY0_PIN, PIN_MODE_INPUT);
    while(1)
    {
        if(rt_pin_read(KEY0_PIN)==PIN_LOW)
        {
            rt_kprintf(&quot;按键按下!&quot;);
        }
        rt_thread_mdelay(100);
    }
}

</code></pre>
<p>目标2：了解I2C设备的使用步骤，能通过RTT I2C设备读取到板载I2C硬件从设备的地址。<br>
使用I2C设备的一般步骤为</p>
<ol>
<li>获取I2C设备</li>
</ol>
<pre><code class="language-c">rt_device_t rt_device_find(const char* name);
</code></pre>
<ol start="2">
<li>传输数据</li>
</ol>
<pre><code class="language-c">rt_size_t rt_i2c_transfer(struct rt_i2c_bus_device *bus,
                          struct rt_i2c_msg         msgs[],
                          rt_uint32_t               num);
</code></pre>
<p>如果不知道从机地址,只能向总线依次发送地址,直到从机响应为止.<br>
目标3：了解SPI设备的实验步骤，知道CS引脚如何设置。<br>
使用SPI设备的一般操作为</p>
<ol>
<li>挂载SPI设备</li>
</ol>
<pre><code class="language-c">rt_err_t rt_hw_spi_device_attach(const char *bus_name, const char *device_name, GPIO_TypeDef* cs_gpiox, uint16_t cs_gpio_pin);
</code></pre>
<ol start="2">
<li>配置SPI设备</li>
</ol>
<pre><code class="language-c">rt_err_t rt_spi_configure(struct rt_spi_device *device,struct rt_spi_configuration *cfg)
</code></pre>
<ol>
<li>访问SPI设备<br>
<img src="https://baldstudio.cn/post-images/1587971222345.png" alt="" loading="lazy"></li>
</ol>
<p>设置CS引脚是在挂载SPI设备的时候指定的.</p>
<h3 id="作业">作业</h3>
<p>作业1【学习营实战——2】：根据群里分享的视频《4.常用的外设驱动添加》以及源码目录下的文档 <a href="https://github.com/RT-Thread/rt-thread/blob/master/bsp/stm32/docs/STM32%E7%B3%BB%E5%88%97%E5%A4%96%E8%AE%BE%E9%A9%B1%E5%8A%A8%E6%B7%BB%E5%8A%A0%E6%8C%87%E5%8D%97.md">rt-thread/bsp/stm32/docs/STM32系列外设驱动添加指南.md</a>，让自己的开发板某个指定的串口能打印rt-thread 的 log，输入help回车可以出现系统命令。<br>
添加指定串口,并将FinSH输出重定向到新的串口的步骤是:</p>
<ol>
<li>在CubeMX中打开串口外设,生成代码.</li>
<li>在board文件夹中的kconfig文件中添加开启相应串口的菜单项.</li>
<li>在menuconfig中将console的设备名称改为新的串口设备名称.<br>
作业2：总结PWM设备的一般使用步骤。<br>
使用PWM设备时,要在CubeMX中使能 internal Clock 时钟，然后为 channelx 选项选择PWM Generation CHx,然后修改Kconfig,添加菜单项,然后在config文件中添加相应的定义.</li>
</ol>
<h3 id="总结">总结</h3>
<p>本周学会了env的使用，IO框架以及几个基础外设的使用，会为finsh配置指定串口。</p>

                </div>
            </article>
        </div>

        
            <div class="next-post">
                <div class="next gt-c-content-color-first">下一篇</div>
                <a href="https://baldstudio.cn/post/rt-thread-xue-xi-bi-ji-er-nei-he-dui-xiang/" class="post-title gt-a-link">
                    RT-Thread学习笔记（二）内核对象
                </a>
            </div>
        

        

        <div class="site-footer gt-c-content-color-first">
    <div class="slogan gt-c-content-color-first">Keep Foolish, Keep Hungry</div>
    <div class="social-container">
        
            
        
            
        
            
        
            
        
            
        
            
        
    </div>
    <div class="footer-info">
        Powered by <a href="https://github.com/jch2138" target="_blank">BalDStudio</a>
    </div>
    <div>
        Theme by <a href="https://imhanjie.com/" target="_blank">imhanjie</a>, Powered by <a
                href="https://github.com/getgridea/gridea" target="_blank">Gridea | <a href="https://baldstudio.cn/atom.xml" target="_blank">RSS</a></a>
    </div>
</div>

<script>
    hljs.initHighlightingOnLoad()
</script>


    </div>
</div>
</body>
</html>
